<section>
  <h3>Tipping pattern</h3>
  <div class="row">
    <div class="col-60">
      <p>
        The owner of a bistro called <span class="em">First Crush</span> in Potsdam, New York, was interested in studying the <span class="danger">tipping patterns of its patrons</span>. 
      </p>
      <p class="down-2 no-margin-bottom">
        <i class="fas fa-arrow-circle-right info"></i>
        He collected restaurant bills over a 
        two-week period that he believes provide a
        <span class="info">good sample of his customers</span>. He recorded the data from 157 bills including:
      </p>
      <ul class="small">
        <li>amount of the bill</li>
        <li>amount of the tip</li>
        <li>corresponding percentage of the tip</li>
        <li>number of customers in the group</li>
        <li>whether or not a credit card was used</li>
        <li>day of the week</li>
        <li>coded identity of the server</li>
      </ul>
    </div>
    <div class="col-40">
      <img src="content/img/regression-tipping-first-crush.jpg" width=100% class="rounded">
      <span class="smaller">(Multivariate dataset)</span>
    </div>
  </div>
</section>

<section data-transition="slide-in fade-out">
  <h3>Tipping pattern data</h3>
  <p class="u em">
    1) We want to predict the tip amount based on the bill amount.
  </p>
  <div class="row">
    <div class="col-50">
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_1"></use>
        <use class="fragment" data-fragment-index=1 xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_2"></use>
        <use class="fragment" data-fragment-index=2 xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_4"></use>
      </svg>
    </div>
    <div class="col-50 fragment" data-fragment-index=0>
      <p class="small">
        The scatterplot of the data show:
      </p>
      <ul class="small icon">
        <li class="play">strong <span class="danger">positive relationship</span> in the data</li>
        <li class="play">few <span class="danger">outliers</span> (big tippers) above the main pattern</li>
      </ul>
    </div>
  </div>
  <p class="small fragment" data-fragment-index=1 >
    <i class="fa fa-arrow-circle-right info"></i>
    If we calculate correlation, we obtain $r=0.915$, reinforcing the fact that
    the data have a <span class="u">strong positive linear relationship</span>.
  </p>
  <p class="small fragment" data-fragment-index=2 >
    <i class="fa fa-arrow-circle-right danger"></i>
    We can build a linear model of the association.
  </p>
</section>

<section data-transition="fade-in slide-out">
  <h3>Tipping pattern data</h3>
  <p class="u em">
    1) We want to predict the tip amount based on the bill amount.
  </p>
  <div class="row">
    <div class="col-50">
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_1"></use>
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_2"></use>
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_4"></use>
      </svg>
    </div>
    <div class="col-50">
      <p>
        Regression line equation: <br>
        $y=-0.292+\texclass{danger}{0.182}x$ <br>
        <span class="em">What does this slope mean?</span>
      </p>
      <p class="down-4">
        <span class="warning">$R^2=0.837$</span><br>
        <span class="em">What does this $R^2$ mean?</span>
      </p>
    </div>
  </div>
  <p class="fragment" data-fragment-index=1 >
    <i class="fas fa-arrow-circle-right danger"></i>
    The slope of $0.182$ indicates that for every extra dollar in the restaurant bill the tip will increase, <span class="danger">on average</span>, by about $\$0.18$ (The <span class="danger">typical</span> tip rate at this restaurant is <span class="danger">roughly</span> $18\%$ of the total bill).
  </p>
  <p class="fragment" data-fragment-index=2 >
    <i class="fas fa-arrow-circle-right warning"></i>
    $\approx 84\%$ of the variation in the amount in tip can be <span class="warning">explained</span> by the variation in bill amount.
  </p>
</section>

<section>
  <h3>Inference about the slope</h3>
  <p class="u">
    How to get an estimate of the <span class="danger">true value of the average tip rate</span> at <span class="em">First Crush</span>?
  </p>
  <p class="fragment" data-fragment-index=1>
    <i class="fas fa-arrow-circle-right success"></i>
    Compute the $95\%$ confidence intervals of the 
    slope (<span class="success">$\beta_1$</span>) for the relationship between tip amount and bill amount.
  </p>
  <div class="row">
    <div class="col-50">
      <p class="framed border-info bg-info-light fragment" data-fragment-index=2>
        <span class="white u em">Method #1:</span>
        Bootstrap of the (x,y) pairs data points.
      </p>
      <p class="fragment" data-fragment-index=3>
        <i class="fas fa-arrow-circle-right info"></i>
        generation of pseudo data is the more usual
        form of bootstrapping for regression analysis.
        The approach is robust
        in that if an incorrect model is fitted an
        <span class="info">appropriate measure of parameter
        uncertainty</span> is still obtained.
      </p>
    </div>
    <div class="col-50">
      <p class="framed border-danger bg-danger-light fragment" data-fragment-index=2>
        <span class="white u em">Method #2:</span>
        Bootstrap of the residuals.
      </p>
      <p class="fragment" data-fragment-index=3>
        <i class="fas fa-arrow-circle-right danger"></i>
        implicitly <span class="danger">assumes that the functional form of the model is correct</span> (even though no assumption is made about the shape of the error distribution).
      </p>
    </div>
  </div>
</section>

<section>
  <h3>Bootstrap CIs for regression</h3>
  <img src="content/img/regression-bootstrap-ci95.svg" width=90%>
</section>

<section data-external-replace="slide-animation-linear-regression-ci95.html"></section>

<section data-transition="slide-in fade-out">
  <h3>Inference about the slope</h3>
  <div class="row">
    <div class="col-90">
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_1"></use>
        <use class="fragment" data-fragment-index=1 xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_3"></use>
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_2"></use>
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_4"></use>
      </svg>
    </div>
  </div>
</section>

<section data-transition="fade-in slide-out">
  <h3>Inference about the slope</h3>
  <div class="row">
    <div class="col-50">
      <p class="u em">
        Slope sampling distribution
      </p>
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-resampling-slope-ci95.svg#axes_1"></use>
        <use xlink:href="content/img/regression-tipping-resampling-slope-ci95.svg#axes_2"></use>
        <use xlink:href="content/img/regression-tipping-resampling-slope-ci95.svg#axes_3"></use>
      </svg>
      <p class="smaller fragment">
        <i class="fas fa-arrow-circle-right danger"></i>
        We are 95% confident that the true value of the <span class="danger">population slope $\beta_1$</span> is in the interval $(0.166, 0.201)$. The true 
        <span class="danger">average tipping
        rate</span> of the patrons of <span class="em">First Crush</span> is 
        between $16\%$ and $20\%$.
      </p>
    </div>
    <div class="col-50">
      <p class="u em center">
        Intercept sampling distribution
      </p>
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-resampling-intercept-ci95.svg#axes_1"></use>
        <use xlink:href="content/img/regression-tipping-resampling-intercept-ci95.svg#axes_2"></use>
        <use xlink:href="content/img/regression-tipping-resampling-intercept-ci95.svg#axes_3"></use>
      </svg>
      <p class="smaller fragment">
        <i class="fas fa-arrow-circle-right success"></i>
        We are 95% confident that the true value of the <span class="success">population intercept $\beta_0$</span> is in the interval $(-0.674, 0.048)$. If there is 
        <span class="success">no bill</span>, there is probably <span class="success">no tip</span> <i class="far fa-smile"></i>
      </p>
    </div>
  </div>
</section>

<section data-transition="slide-in fade-out">
  <h3>What about tip percentage?</h3>
  <p>
    Most people use a fairly regular percentage (which may vary from person to person) of the total bill when deciding how big a tip to leave. 
  </p>
  <p>
    Some economists have theorized that
    <span class="danger">i) people tend to reduce that percentage when the bill gets large</span>, but in the other hand
    <span class="danger">ii) larger groups of customers might be more generous as a group due to peer pressure</span>.
    (<span class="em">Loewenstein, G. and Prelec, D. (1992). Anomalies in Intertemporal Choice: Evidence and an Interpretation, Quarterly Journal of Economics, 1992;107:573â€“97</span>)
  </p>
  <p class="framed border-pop down-3">
    How could we study these two questions using 
    our dataset? <br>
    Could we use regression analysis? What parameter would
    particularly be of interest?
  </p>
</section>



<section data-transition="fade">
  <h3>What about tip percentage?</h3>
  <div class="row">
    <div class="col-45">
      <p>
        From our dataset, we can calculate the percentage
        of the bill that each tip represents, and display
        the scatterplot of the percentage in fuction of 
        the total bill.
      </p>
      <p class="fragment" data-fragment-index=2>
        <i class="fas fa-arrow-circle-right danger"></i>
        We can compute the $95\%$ confidence interval of 
        the slope of this regression line and check if 
        $0$ (no positive association) is inside.
      </p>
    </div>
    <div class="col-55">
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_1"></use>
        <use class="fragment" data-fragment-index=4 xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_4"></use>
        <use xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_3"></use>
        <use class="fragment" data-fragment-index=1 xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_2"></use>
      </svg>
    </div>
  </div>
  <p class="fragment" data-fragment-index=3>
    <i class="fas fa-arrow-circle-right pop"></i>
    We select bootstrap samples (pairs, n=157), with replacement, from the dataset. For each bootstrap sample, we run the regression model, compute the sample slope, and save it to form the bootstrap distribution.
  </p>
</section>

<section data-transition="fade-in slide-out">
  <h3>What about tip percentage?</h3>
  <div class="row">
    <div class="col-45">
      <p>
        From our dataset, we can calculate the percentage
        of the bill that each tip represents, and display
        the scatterplot of the percentage in fuction of 
        the total bill.
      </p>
      <p>
        <i class="fas fa-arrow-circle-right danger"></i>
        We can compute the $95\%$ confidence interval of 
        the slope of this regression line and check if 
        $0$ (no positive association) is inside.
      </p>
    </div>
    <div class="col-55">
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-resampling-pcenttipping-slope-ci95.svg#axes_1"></use>
        <use xlink:href="content/img/regression-tipping-resampling-pcenttipping-slope-ci95.svg#axes_2"></use>
        <use class="fragment" data-fragment-index=1 xlink:href="content/img/regression-tipping-resampling-pcenttipping-slope-ci95.svg#axes_3"></use>
      </svg>
    </div>
  </div>
  <p class="fragment" data-fragment-index=4>
    <i class="fa fa-arrow-circle-right pop"></i>
    It does <span class="pop">not include the null value of zero</span>, so we reject $H_0$ in favor of a two-tailed alternative at a the $5\%$ level. In fact, since the confidence interval includes only positive values, this strongly suggests that the true slope is above zero. Thus we have evidence that there is some <span class="pop">positive relationship between the amount of a tip and the size of a bill</span> at this restaurant.
  </p>
</section>

<section data-transition="slide-in fade-out">
  <h3>What about the outliers?</h3>
  <div class="row">
    <div class="col-50">
      <svg width="100%" viewBox="0 0 432 288">
        <use class="fragment" data-fragment-index=1 xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_5"></use>
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_1"></use>
      </svg>
    </div>
    <div class="col-50">
      <svg width="100%" viewBox="0 0 432 288">
        <use class="fragment" data-fragment-index=1 xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_5"></use>
        <use xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_1"></use>
      </svg>
    </div>
  </div>
  <p>
    The scatterplot show a <span class="danger">few possible outliers</span> from the pattern of the rest of the data. Three very generous customers left tips that were more than 30% of the bill. 
  </p>
  <p class="quoted">
    Do those points have had a <span class="danger">large effect on the conclusions we did</span> based on the slopes of either of the relationships we studied?
  </p>
</section>

<section data-transition="fade">
  <h3>What about the outliers?</h3>
  <div class="row">
    <div class="col-50">
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_5"></use>
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_1"></use>
      </svg>
    </div>
    <div class="col-50">
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_5"></use>
        <use xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_1"></use>
      </svg>
    </div>
  </div>
  <p class="framed border-pop">
    One way to investigate this question is to <span class="strong pop">omit those cases from the data</span> and re-run the analysis without them.
  </p>
</section>

<section data-transition="fade">
  <h3>What about the outliers?</h3>
  <div class="row">
    <div class="col-50">
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_5"></use>
        <use xlink:href="content/img/regression-tipping-data-tip-vs-bill.svg#axes_1"></use>
      </svg>
    </div>
    <div class="col-50">
      <svg width="100%" viewBox="0 0 432 288">
        <use xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_5"></use>
        <use xlink:href="content/img/regression-tipping-data-pcenttip-vs-bill.svg#axes_1"></use>
      </svg>
    </div>
  </div>
  <table class="small">
    <col width=30%>
    <col width=35%>
    <col width=35%>
    <tbody>
      <tr class="center">
        <td></td>
        <td class="bg-info-light center">Tip vs Bill</td>
        <td class="bg-danger-light center">Tip (%) vs Bill</td>
      </tr>
      <tr class="border-bottom">
        <td>Full dataset</td>
        <td>$y=-0.292+\texclass{orange}{0.182}x$</td>
        <td>$y=15.508+\texclass{pop}{0.049}x$</td>
      </tr>
      <tr class="border-bottom">
        <td>No outliers</td>
        <td>$y=-0.404+\texclass{orange}{0.183}x$</td>
        <td>$y=14.918+\texclass{pop}{0.056}x$</td>
      </tr>
    </tbody>
  </table>
</section>

<section data-transition="fade-in slide-out">
  <h3>What about the outliers?</h3>
  <table class="small">
    <col width=30%>
    <col width=35%>
    <col width=35%>
    <tbody>
      <tr>
        <td></td>
        <td class="bg-info-light">Tip vs Bill</td>
        <td class="bg-danger-light">Tip (%) vs Bill</td>
      </tr>
      <tr class="border-bottom">
        <td>Full dataset</td>
        <td>$y=-0.292+\texclass{orange}{0.182}x$</td>
        <td>$y=15.508+\texclass{pop}{0.049}x$</td>
      </tr>
      <tr class="border-bottom">
        <td>No outliers</td>
        <td>$y=-0.404+\texclass{orange}{0.183}x$</td>
        <td>$y=14.918+\texclass{pop}{0.056}x$</td>
      </tr>
    </tbody>
  </table>
  <p class="small">
    <i class="fas fa-arrow-circle-right success"></i>
    After dropping the three generous data points, we see
    that the outliers have a negligible effect on the slopes of the relationships we studied.
  </p>
  <table class="small down-2">
    <col width=30%>
    <col width=35%>
    <col width=35%>
    <tbody>
      <tr>
        <td></td>
        <td class="bg-info-light">Tip vs Bill</td>
        <td class="bg-danger-light">Tip (%) vs Bill</td>
      </tr>
      <tr class="border-bottom">
        <td>Full dataset</td>
        <td>$[0.166, 0.201]$</td>
        <td>$[0.005, 0.094]$</td>
      </tr>
      <tr class="border-bottom">
        <td>No outliers</td>
        <td>$[0.168, 0.202]$</td>
        <td>$[0.015, 0.101]$</td>
      </tr>
    </tbody>
  </table>
  <p>
    <i class="fas fa-arrow-circle-right success"></i>
    The 95% confidence intervals for these slopes, based on the data without outliers, are a bit narrower, but otherwise similar to what we obtained, from the full dataset.
  </p>
  <p>
    <i class="fas fa-arrow-circle-right warning"></i>
    The outliers did not affect our conclusions.
  </p>
</section>

<section>
  <h3>Scope of our conclusions?</h3>
  <p>
    <span class="u em danger">Data Collection:</span>
    What population can we draw inferences about from the dataset we anlayze?
    The sample was generated by collecting <span class="danger">all bills over several nights at the <span class="em">First Crush</span> restaurant</span>.
  </p>
  <p class="fragment" data-fragment-index=1>
    <i class="fas fa-arrow-circle-right pop"></i>
    Because the data are all from one restaurant, the population of interest is all bills and tips at this restaurant. 
  </p>
  <p class="fragment" data-fragment-index=1>
    <i class="fas fa-arrow-circle-right pop"></i>
    The original sample was <span class="pop">not a random sample of all bills</span>, but rather the data were collected from all bills in a <span class="pop">certain time frame</span>. That might introduce bias if the days for the bills in the sample are different in some substantial way (for example, over a holiday season or only weekends). However, <span class="pop">the owner indicates</span> that the days for which bills were sampled are <span class="pop">representative of the business at his restaurant</span>. 
  </p>
  <p class="fragment" data-fragment-index=1>
    <i class="fas fa-arrow-circle-right pop"></i>
    As data analysts we might alert the owner to the <span class="pop">possibility of bias</span> when reporting our findings, but we proceed for now with the assumption that the sample is representative of all bills at this restaurant.
  </p>
</section>